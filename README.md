# Object Identification Under Known Dynamics: A PIRNN Approach for UAV Classification

This repository contains the code, data, and methods needed to use a ResNet PINN (PIRNN) to classify UAVs based on their trajectory data. It includes the simulations for UAV trajectories as well as the PIRNN structure.

## Project Structure 
- Fixed_wings / Helicopter / Quadcopter
    - `FW_ScenarioSampler.py`, `Heli_ScenarioSampler.py`, `Quad_ScenarioSampler.py` - Generates initial control and state data based on given condition 
    - `FW_traj_generator.py`, `Heli_traj_generator.py`, `Quad_traj_generator.py` - Used to simulate trajectories for various conditions
    - `FixedWingUAV.py`, `HelicopterUAV.py`, `quadcopter.py` - Contains the dynamics needed to compute the time derivatives of a state
    - `fw_dataset.npz`, `heli_dataset.npz`, `quad_dataset.npz` - Storage for data generated by the trajectory generators
- results - contains the saved pretrained model, loss values, and loss plots
    - `Pinn_model.pth`, `loss_plot.png`, `normalization_stats.npz`, `train_losses.npy`, `val_losses.npy`
- `Noise.py` - Generates gaussian noise
- `PINN.py` - Neural network structure for the ResNet style PINN
- `PINN_Classifier.py` - Used to train the neural network and then for classification
- `README.md` - Project documentation for users
- `UAVDataset.py` - Builds a proper dataset for UAV trajectories to use with neural network training
- `data_distribution.py` - Applies PCA and t-SNE to reduce data to 2D form and visualize class separation
- `load_model.py` - Loads the pretrained model and tests for unseen trajectories
- `run_main.py` - Uses the libraries needed and used to train, classify, and generate an evaluation report

---

## Requirements
- Python 3.11.12
- matplotlib==3.10.3
- numpy==2.3.1
- pandas==2.3.1
- scikit_learn==1.7.0
- scipy==1.16.0
- torch==2.7.1

Install dependencies using:

```bash
pip install r- requirements.txt
```

---


## How to Run

### Step 1: Setup

Download or clone the repository:

```bash
git clone https://github.com/NyiNyi-14/PINN_based_UAV_Classification.git
```

All scripts will need to be in the same directory.

### Step 2: Update the Working Directories

Before running the code, set the appropriate input and output paths in the scripts `FW_traj_generator.py`, `Heli_traj_generator.py`, `quadcopter.py`, `load_model.py`, and `run_main.py` to specify where the results should be directed.

### Step 3: Running the code

Proceed and run the code in your preferred code editor.

---

## Visualizations

![Sample Frame](media/pinn.png)
<p align="center">
  Figure 1: Visualization of the entire PIRNN structure. Includes the inputs to the PIRNN, the predicted/true outputs, and the hybrid loss function
</p>

&nbsp;

![Sample Frame](media/skip_and_class.png)
<p align="center">
  Figure 2: (a) Visualization of the skip connections present in the PIRNN with their respective weights (b) Softmax confidence estimation
</p>

&nbsp;

<p align="center">
  <img src="media/pcastuff.png" width="900">
</p>
<p align="center">
  Figure 3: PCA (left) and t-SNE (right) plots generated by <code>data_distribution.py</code>
</p>

&nbsp;

![Sample Frame](media/trajs.png)
<p align="center">
  Figure 4: Examples of UAV trajectories generated by <code>quadcopter.py</code>, <code>FW_traj_generator.py</code>, and <code>Heli_traj_generator.py</code>
</p>

---

## Performance Evaluation of the Proposed Algorithm

<p align="center">
  <img src="media/table5.png" width="720">
</p>
<p align="center">
  Figure 5: Classification report of noiseless data
</p>

---

## Robustness Analysis of the Proposed Algorithm


<p align="center">
  <img src="media/noisyetns.png" width="800">
</p>
<p align="center">
  Figure 6: Noise equations used to add noise to state and time derivative state data
</p>

&nbsp;

<p align="center">
  <img src="media/table6.png" width="650">
</p>
<p align="center">
  Figure 7: Classification performance table for varying levels of noise
</p>

---



## Related Work
This project builds upon recent advances in Physics-Informed Neural Networks (PINNs) and their application to dynamical systems and UAV modeling. Therefore the following topics are highly related and useful
- Physics-Informed Neural Networks
- Residual Neural Network Structures
- UAV Modeling and Simulation
- Object Classification using Neural Networks

---

## Citation

If you use this work, please cite the related paper as follows:

```bash

```

---

## Authors

**Nyi Nyi Aung** 

PhD Student, Mechanical and Industrial Engineering - LSU, USA

MSc, Sustainable Transportation and Electrical Power Systems - UniOvi, Spain

BE, Electrical Power - YTU, Myanmar

&nbsp;

**Neil Muralles**

Undergraduate Researcher, Mechanical and Industrial Engineering

Mechanical Engineering Student

Louisiana State University

&nbsp;

**Adrian Stein, PhD**

Assistant Professor

Department of Mechanical and Industrial Engineering

Louisiana State University

---
